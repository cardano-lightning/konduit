use aiken/collection/list
use konduit/wellformed

pub type TBody {
  index: Int,
  amount: Int,
  timeout: Int,
  image: ByteArray,
}

pub type TCheque {
  skey: ByteArray,
  vkey: ByteArray,
  tag: ByteArray,
  preimage: ByteArray,
  body: TBody,
  message: ByteArray,
  signature: ByteArray,
}

fn run_verify_unlocked(tc: TCheque) {
  let TCheque {
    vkey,
    tag,
    preimage,
    body: TBody { index, amount, timeout, image },
    signature,
    ..
  } = tc
  let unlocked = ((index, amount, timeout, image), signature, preimage)
  wellformed.verify_unlocked(0, vkey, tag, unlocked)
}

test test_verify_unlocked() {
  cs |> list.all(fn(tc) { run_verify_unlocked(tc) })
}

pub const cs =
  [
    TCheque {
      skey: #"0000000000000000000000000000000000000000000000000000000000000000",
      vkey: #"3b6a27bcceb6a42d62a3a8d02a6f0d73653215771de243a63ac048a18b59da29",
      tag: #"6c3b9aa767f785b537c0d8ba5fa54677e6a6e281320dfbb27c889b8fa4",
      preimage: #"7c889b8fa460670f7946023267660de1bdb07e94cb14ae8c3c922e6a9d5338d4",
      body: TBody {
        index: 13080132717333068652,
        amount: 8594738769458413623,
        timeout: 12896916468484187878,
        image: #"4a967d061be254131c705c521ba9b523148453cf78495cc718f9f2cafb9877a5",
      },
      message: #"6c3b9aa767f785b537c0d8ba5fa54677e6a6e281320dfbb27c889b8fa49f1bb585f767a79a3b6c1b7746a55fbad8c0371bb2fb0d3281e2a6e658204a967d061be254131c705c521ba9b523148453cf78495cc718f9f2cafb9877a5ff",
      signature: #"9b96a8f3859f140f076b73868eb8d424b4b3e462351eb1410565e8e48cfbfdccb4a0a0d04d6ddf9d3e93668132570f39fe6c37331e7478d0717e9d61b8be1003",
    },
    TCheque {
      skey: #"0100000000000000000000000000000000000000000000000000000000000000",
      vkey: #"cecc1507dc1ddd7295951c290888f095adb9044d1b73d696e6df065d683bd4fc",
      tag: #"b10da48cea4c09676b8e0efcd806941465060736032bb898420d0863dc",
      preimage: #"420d0863dca72538e5cb1bd553f29f485820e2e9368deab5178aff7ee0df0976",
      body: TBody {
        index: 7424550030962593201,
        amount: 1482817706323250795,
        timeout: 11004592982271133285,
        image: #"4700cae0a70e27f63c6be741a413a5cbb019138cf817da4bcdb46afc78f51b95",
      },
      message: #"b10da48cea4c09676b8e0efcd806941465060736032bb898420d0863dc9f1b67094cea8ca40db11b149406d8fc0e8e6b1b98b82b033607066558204700cae0a70e27f63c6be741a413a5cbb019138cf817da4bcdb46afc78f51b95ff",
      signature: #"6db751269b0f40e6e50e9378ba974ad327d1c77f6c71361689740cffee912c26604721281cc1be801313c7efc2bbf9471520af89a8bdceeb084a91509e73360d",
    },
    TCheque {
      skey: #"0200000000000000000000000000000000000000000000000000000000000000",
      vkey: #"6b79c57e6a095239282c04818e96112f3f03a4001ba97a564c23852a3f1ea5fc",
      tag: #"c51b8a31c98b9fe13065b485c9f8658c194c430843570ccac2720a3b30",
      preimage: #"c2720a3b30b47adb412b8a2e80a7da3836e87ed0767700adb3f0bd215a6b81ee",
      body: TBody {
        index: 16257866876066601925,
        amount: 10116765682372994352,
        timeout: 14559107640795024409,
        image: #"f47a9862f9cafa8fc94a9766cbb11b4c787e4fe011a25e2b39e686cfb36dc289",
      },
      message: #"c51b8a31c98b9fe13065b485c9f8658c194c430843570ccac2720a3b309f1be19f8bc9318a1bc51b8c65f8c985b465301bca0c574308434c195820f47a9862f9cafa8fc94a9766cbb11b4c787e4fe011a25e2b39e686cfb36dc289ff",
      signature: #"ab845a8bcd5bed1ef16069f9597173d39a4d76beeb456a43577cd58bb7daa4d5695fee735ff5b9fbbe6fac2ff47edc70b7dbae9986c343f7829fd1ddf915df0d",
    },
    TCheque {
      skey: #"0400000000000000000000000000000000000000000000000000000000000000",
      vkey: #"9be3287795907809407e14439ff198d5bfc7dce6f9bc743cb369146f610b4801",
      tag: #"22cfaefc92e4edb9b0ae01a63a95df11f1279b7b6bdde4e048f6ece8f8",
      preimage: #"48f6ece8f8c8f2c2de97544a163f7d302315ee0f7869fbdcfd863e4f4796d612",
      body: TBody {
        index: 13397615786452766498,
        amount: 1287912097577021104,
        timeout: 16205320812890892273,
        image: #"dfdf67a018038a6fc190437bd132fd89f95b4691583d827438e0c9c9ca76d6f3",
      },
      message: #"22cfaefc92e4edb9b0ae01a63a95df11f1279b7b6bdde4e048f6ece8f89f1bb9ede492fcaecf221b11df953aa601aeb01be0e4dd6b7b9b27f15820dfdf67a018038a6fc190437bd132fd89f95b4691583d827438e0c9c9ca76d6f3ff",
      signature: #"5486342b6f84683946cbef177911585ede614040ab3ab945aa381df463c13e7942d61f5c5012ae155b90026346b64e9d1145b201dff4e91b4855edacacabd60f",
    },
    TCheque {
      skey: #"0500000000000000000000000000000000000000000000000000000000000000",
      vkey: #"f4bd46521ce7b57899ae6f4ca09eddec689327a86a2232d4a3f2a4f39ac68a9e",
      tag: #"5b7b6135be198533f7c7ec46651216b762e6d47e69b408d1bc79d641f9",
      preimage: #"bc79d641f9ae06de27f2dfd4d4d32e6dc23b924aed1e6b49f5f2df014d11dafc",
      body: TBody {
        index: 3712401772566903643,
        amount: 13192752384619366391,
        timeout: 15062487318933071458,
        image: #"aba30dcb46ed04993a25fd6aec8a7b0144db3df5534d33aecc97bde325a73902",
      },
      message: #"5b7b6135be198533f7c7ec46651216b762e6d47e69b408d1bc79d641f99f1b338519be35617b5b1bb716126546ecc7f71bd108b4697ed4e6625820aba30dcb46ed04993a25fd6aec8a7b0144db3df5534d33aecc97bde325a73902ff",
      signature: #"98b5fef802cdaf6607144d63406ba1ac61de18130bb312131b453e92e1afe059132f9afd21fe4de8d88b2357f3de0af48850d3ffcb6de0c3c6d317a7a64a510c",
    },
    TCheque {
      skey: #"0600000000000000000000000000000000000000000000000000000000000000",
      vkey: #"34790764308e0b7b5f7cc9d5cdd29845fd82a03df53d2cffef3c0228547487c5",
      tag: #"e6c2614f6ebd4c6b5055bf86866fae7b56a9602a99133250ba8b7f516d",
      preimage: #"ba8b7f516dff9dc4ddb61d490dae569776fd1218f40be9add7cb0be51cd05f0f",
      body: TBody {
        index: 7731762941764158182,
        amount: 8912183336189777232,
        timeout: 5778702820431669590,
        image: #"cd390dd6a1518e7654ebd7c4bc450223fc067176a9f09cf967b40a5d7e8d9189",
      },
      message: #"e6c2614f6ebd4c6b5055bf86866fae7b56a9602a99133250ba8b7f516d9f1b6b4cbd6e4f61c2e61b7bae6f8686bf55501b503213992a60a9565820cd390dd6a1518e7654ebd7c4bc450223fc067176a9f09cf967b40a5d7e8d9189ff",
      signature: #"5efb36c6bfec41ac64305a90e082e2c55cf3db6ee3f404c03f1b46816954b3f72b1adefa66e8adbf95fe61a690246fd6b160681bf3599954a59baa2cee25cf05",
    },
    TCheque {
      skey: #"0700000000000000000000000000000000000000000000000000000000000000",
      vkey: #"a2fa2f4a355ba2e907a53009e9e37caddf7ac7e66a08ba07631f553072b3f24c",
      tag: #"bb43d723345365283a299b2ed359012b31952445b9704bb4e33a3e09b6",
      preimage: #"e33a3e09b6b70bba88db37125f1cec9926fe99cfa34dff5b9bb8f53d9f634315",
      body: TBody {
        index: 2910824217569608635,
        amount: 3098856782162503994,
        timeout: 12991601491111613745,
        image: #"af43c0ebc3c8e86bdf2baf31abebf0d97c9f419efae5a671457c0a2693769def",
      },
      message: #"bb43d723345365283a299b2ed359012b31952445b9704bb4e33a3e09b69f1b2865533423d743bb1b2b0159d32e9b293a1bb44b70b9452495315820af43c0ebc3c8e86bdf2baf31abebf0d97c9f419efae5a671457c0a2693769defff",
      signature: #"fee811363e968f3dc4594c6b1a702d237fb5c6ea4039d8609bae51d26e39062e01852f5a41bb4d7fdd6ebb55a3fd0a2f0246107eb60ea9bc83ac82a427cd4b06",
    },
    TCheque {
      skey: #"0800000000000000000000000000000000000000000000000000000000000000",
      vkey: #"d4c5061b81c4682b27a0cfc6459cd9d7892eb60a43f73dd1060b6c478aa7c3d8",
      tag: #"5e969c4ac2f287128d6fd71e7d111dbd19a5b2bea59da5d5d908044a51",
      preimage: #"d908044a514f5f8e768d8307688c2d8fe6aafeed906b92d7c1ac40654ebc8ab0",
      body: TBody {
        index: 1335302730827994718,
        amount: 13627067276579008397,
        timeout: 15394884236430451993,
        image: #"25e257c9cdfd00de38b5a0534c6df3236d3b11b3007e2d23abf97b3494cfb4a5",
      },
      message: #"5e969c4ac2f287128d6fd71e7d111dbd19a5b2bea59da5d5d908044a519f1b1287f2c24a9c965e1bbd1d117d1ed76f8d1bd5a59da5beb2a519582025e257c9cdfd00de38b5a0534c6df3236d3b11b3007e2d23abf97b3494cfb4a5ff",
      signature: #"03bb909181d09567144383cb34e5a5ed5885f902c28e0d4f746b39e0e310f34f438a360aeb5538c6d4bfe0671dc7c65f5fb34896ce75c2b3d9a81472d2457d08",
    },
    TCheque {
      skey: #"0900000000000000000000000000000000000000000000000000000000000000",
      vkey: #"bb5c672482b0dcca91a21a4ed63b15afde8aa1378da72cd01b349589d6e7dd6a",
      tag: #"1f942b810f26371d126fb6f3ceb731c85bc46ef778621f58fd23e1a095",
      preimage: #"fd23e1a095796d2cfffb1adc49a4fe9587bac7ae71e3624ffcf344877a83fb94",
      body: TBody {
        index: 2105193198852477983,
        amount: 14425513180924374802,
        timeout: 6349902271302517851,
        image: #"38bce829cd8c1e2503902f90fbef1f4e9cce6a4a0f6d143269e88cb0833c9158",
      },
      message: #"1f942b810f26371d126fb6f3ceb731c85bc46ef778621f58fd23e1a0959f1b1d37260f812b941f1bc831b7cef3b66f121b581f6278f76ec45b582038bce829cd8c1e2503902f90fbef1f4e9cce6a4a0f6d143269e88cb0833c9158ff",
      signature: #"fd2b12ec84b3cc702b4e196cea4a9a8c669b80797481ea1f7414d336944db04cbb0ea1d3a906b357bde99ea7b6d58c100cd2006ec7047bc286f821d17fde0c0c",
    },
  ]
